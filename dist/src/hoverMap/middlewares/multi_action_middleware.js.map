{"version":3,"sources":["../../../../src/hoverMap/middlewares/multi_action_middleware.js"],"names":["multiActionMiddleware","wait","action","type","actions","Error","actionResults","map","a","params","Promise","all","act","promise","then","next","err"],"mappings":";;;;;kBAGwBA,qB;;AAHxB;;AACA;;;;;;AAEe,SAASA,qBAAT,OAAuC;AAAA,MAAPC,IAAO,QAAPA,IAAO;;AACpD,SAAO;AAAA,WACL,kBAAU;AACR,UAAIC,UAAUA,OAAOC,IAAP,qCAAd,EAA4C;AAC1C,YAAI,CAAC,sBAAQD,OAAOE,OAAf,CAAL,EAA8B;AAC5B,gBAAM,IAAIC,KAAJ,CAAU,0EAAV,CAAN;AACD;;AAED,YAAMC,gBAAgBJ,OAAOE,OAAP,CAAeG,GAAf,CAAmB;AAAA,iBAAKC,EAAEN,OAAOO,MAAT,CAAL;AAAA,SAAnB,CAAtB;;AAEA,YAAIR,IAAJ,EAAU;AACR,iBAAOS,QAAQC,GAAR,CAAYL,cAAcC,GAAd,CAAkB;AAAA,mBAAQK,OAAOA,IAAIC,OAAZ,IAAwBD,GAA/B;AAAA,WAAlB,CAAZ,EAAmE;AAAnE,WACJE,IADI,CAEH,2BAAmB;AAAE;AACnB,mBAAOR,cAAcC,GAAd,CAAkB;AAAA,qBAAKQ,KAAKP,CAAL,CAAL;AAAA,aAAlB,CAAP;AACD,WAJE,EAKH,eAAO;AACL,kBAAM,IAAIH,KAAJ,CAAUW,GAAV,CAAN;AACD,WAPE,CAAP;AASD;;AAED,eAAOV,cAAcC,GAAd,CAAkB;AAAA,iBAAKQ,KAAKP,CAAL,CAAL;AAAA,SAAlB,CAAP;AACD;;AAED,aAAOO,KAAKb,MAAL,CAAP;AACD,KAzBI;AAAA,GAAP;AA0BD","file":"multi_action_middleware.js","sourcesContent":["import {MULTI_ACTION} from 'consts/multi_action_types.js';\nimport isArray from 'lodash.isarray';\n\nexport default function multiActionMiddleware({wait}) {\n  return next =>\n    action => {\n      if (action && action.type === MULTI_ACTION) {\n        if (!isArray(action.actions)) {\n          throw new Error('action of type MULTI_ACTION must contain actions property of Array type.');\n        }\n\n        const actionResults = action.actions.map(a => a(action.params));\n\n        if (wait) {\n          return Promise.all(actionResults.map(act => (act && act.promise) || act)) // support promise middleware interface\n            .then(\n              resolvedActions => { // resolvedActions unused\n                return actionResults.map(a => next(a));\n              },\n              err => {\n                throw new Error(err);\n              }\n            );\n        }\n\n        return actionResults.map(a => next(a));\n      }\n\n      return next(action);\n    };\n}\n"]}