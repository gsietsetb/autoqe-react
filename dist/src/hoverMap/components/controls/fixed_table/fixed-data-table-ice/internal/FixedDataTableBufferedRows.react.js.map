{"version":3,"sources":["../../../../../../../../src/hoverMap/components/controls/fixed_table/fixed-data-table-ice/internal/FixedDataTableBufferedRows.react.js"],"names":["React","require","FixedDataTableRowBuffer","FixedDataTableRow","cx","emptyFunction","joinClasses","PropTypes","FixedDataTableBufferedRows","createClass","displayName","propTypes","defaultRowHeight","number","isRequired","firstRowIndex","firstRowOffset","fixedColumns","array","height","offsetTop","onRowClick","func","onRowMouseDown","onRowMouseEnter","rowClassNameGetter","rowsCount","rowGetter","rowHeightGetter","scrollLeft","scrollableColumns","showLastRowBorder","bool","width","getInitialState","_rowBuffer","props","_getRowHeight","rowsToRender","getRows","componentWillMount","_staticRowArray","componentDidMount","_bufferUpdateTimer","setTimeout","_updateBuffer","componentWillReceiveProps","nextProps","setState","clearTimeout","isMounted","getRowsWithUpdatedBuffer","shouldComponentUpdate","componentWillUnmount","length","render","state","i","rowInfo","rowIndex","rowOffsetTop","currentRowHeight","hasBottomBorder","createElement","key","index","data","Math","round","onClick","onMouseDown","onMouseEnter","className","module","exports"],"mappings":"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","file":"FixedDataTableBufferedRows.react.js","sourcesContent":["/**\n * Copyright (c) 2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule FixedDataTableBufferedRows.react\n * @typechecks\n */\n\nvar React = require('./React');\nvar FixedDataTableRowBuffer = require('./FixedDataTableRowBuffer');\nvar FixedDataTableRow = require('./FixedDataTableRow.react');\n\nvar cx = require('./cx');\nvar emptyFunction = require('./emptyFunction');\nvar joinClasses = require('./joinClasses');\n\nvar PropTypes = React.PropTypes;\n\nvar FixedDataTableBufferedRows = React.createClass({displayName: \"FixedDataTableBufferedRows\",\n\n  propTypes: {\n    defaultRowHeight: PropTypes.number.isRequired,\n    firstRowIndex: PropTypes.number.isRequired,\n    firstRowOffset: PropTypes.number.isRequired,\n    fixedColumns: PropTypes.array.isRequired,\n    height: PropTypes.number.isRequired,\n    offsetTop: PropTypes.number.isRequired,\n    onRowClick: PropTypes.func,\n    onRowMouseDown: PropTypes.func,\n    onRowMouseEnter: PropTypes.func,\n    rowClassNameGetter: PropTypes.func,\n    rowsCount: PropTypes.number.isRequired,\n    rowGetter: PropTypes.func.isRequired,\n    rowHeightGetter: PropTypes.func,\n    scrollLeft: PropTypes.number.isRequired,\n    scrollableColumns: PropTypes.array.isRequired,\n    showLastRowBorder: PropTypes.bool,\n    width: PropTypes.number.isRequired,\n  },\n\n  getInitialState:function() /*object*/ {\n    this._rowBuffer =\n      new FixedDataTableRowBuffer(\n        this.props.rowsCount,\n        this.props.defaultRowHeight,\n        this.props.height,\n        this._getRowHeight\n      );\n    return ({\n      rowsToRender: this._rowBuffer.getRows(\n        this.props.firstRowIndex,\n        this.props.firstRowOffset\n      ),\n    });\n  },\n\n  componentWillMount:function() {\n    this._staticRowArray = [];\n  },\n\n  componentDidMount:function() {\n    this._bufferUpdateTimer = setTimeout(this._updateBuffer, 500);\n  },\n\n  componentWillReceiveProps:function(/*object*/ nextProps) {\n    if (nextProps.rowsCount !== this.props.rowsCount ||\n        nextProps.defaultRowHeight !== this.props.defaultRowHeight ||\n        nextProps.height !== this.props.height) {\n      this._rowBuffer =\n        new FixedDataTableRowBuffer(\n          nextProps.rowsCount,\n          nextProps.defaultRowHeight,\n          nextProps.height,\n          this._getRowHeight\n        );\n    }\n    this.setState({\n      rowsToRender: this._rowBuffer.getRows(\n        nextProps.firstRowIndex,\n        nextProps.firstRowOffset\n      ),\n    });\n    if (this._bufferUpdateTimer) {\n      clearTimeout(this._bufferUpdateTimer);\n    }\n    this._bufferUpdateTimer = setTimeout(this._updateBuffer, 400);\n  },\n\n  _updateBuffer:function() {\n    this._bufferUpdateTimer = null;\n    if (this.isMounted()) {\n      this.setState({\n        rowsToRender: this._rowBuffer.getRowsWithUpdatedBuffer(),\n      });\n    }\n  },\n\n  shouldComponentUpdate:function() /*boolean*/ {\n    // Don't add PureRenderMixin to this component please.\n    return true;\n  },\n\n  componentWillUnmount:function() {\n    this._staticRowArray.length = 0;\n  },\n\n  render:function() /*object*/ {\n    var props = this.props;\n    var offsetTop = props.offsetTop;\n    var rowClassNameGetter = props.rowClassNameGetter || emptyFunction;\n    var rowGetter = props.rowGetter;\n\n    var rowsToRender = this.state.rowsToRender;\n    this._staticRowArray.length = rowsToRender.length;\n\n    for (var i = 0; i < rowsToRender.length; ++i) {\n      var rowInfo = rowsToRender[i];\n      var rowIndex = rowInfo.rowIndex;\n      var rowOffsetTop = rowInfo.offsetTop;\n      var currentRowHeight = this._getRowHeight(rowIndex);\n\n      var hasBottomBorder =\n        rowIndex === props.rowsCount - 1 && props.showLastRowBorder;\n\n      this._staticRowArray[i] =\n        React.createElement(FixedDataTableRow, {\n          key: i, \n          index: rowIndex, \n          data: rowGetter(rowIndex), \n          width: props.width, \n          height: currentRowHeight, \n          scrollLeft: Math.round(props.scrollLeft), \n          offsetTop: Math.round(offsetTop + rowOffsetTop), \n          fixedColumns: props.fixedColumns, \n          scrollableColumns: props.scrollableColumns, \n          onClick: props.onRowClick, \n          onMouseDown: props.onRowMouseDown, \n          onMouseEnter: props.onRowMouseEnter, \n          className: joinClasses(\n            rowClassNameGetter(rowIndex),\n            cx('public/fixedDataTable/bodyRow'),\n            hasBottomBorder ? cx('fixedDataTable/hasBottomBorder') : null\n          )}\n        );\n    }\n\n    return React.createElement(\"div\", null, this._staticRowArray);\n  },\n\n  _getRowHeight:function(/*number*/ index) /*number*/ {\n    return this.props.rowHeightGetter ?\n      this.props.rowHeightGetter(index) :\n      this.props.defaultRowHeight;\n  },\n});\n\nmodule.exports = FixedDataTableBufferedRows;\n"]}