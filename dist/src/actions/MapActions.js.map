{"version":3,"sources":["../../../src/actions/MapActions.js"],"names":["query","changeBounds","tableVisibleRowsChange","tableHoveredRowIndexChange","markerHoverIndexChange","showBallon","getDataAsync","ms","data","Promise","setTimeout","r","K_EMUL_ROUNDTRIP_TIME_MS","K_ROW_DEBOUNCE_INTERVAL","asyncActions","raiseSkipError","expireMs","params","visibleRowFirst","visibleRowLast","maxVisibleRows","types","promise","then","markersData","center","zoom","bounds","marginBounds","type","hoveredRowIndex","hoverMarkerIndex","openBalloonIndex"],"mappings":";;;;;;;;QAgCgBA,K,GAAAA,K;QAUAC,Y,GAAAA,Y;QAKAC,sB,GAAAA,sB;QAOAC,0B,GAAAA,0B;QAOAC,sB,GAAAA,sB;QAOAC,U,GAAAA,U;;AApEhB;;AAEA;;AASA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA,IAAMC,eAAe,SAAfA,YAAe;AAAA,MAACC,EAAD,uEAAM,CAAN;AAAA,MAASC,IAAT,uEAAgB,IAAhB;AAAA,SAAyB,IAAIC,OAAJ,CAAY;AAAA,WAAKC,WAAW;AAAA,aAAMC,EAAEH,IAAF,CAAN;AAAA,KAAX,EAA0BD,EAA1B,CAAL;AAAA,GAAZ,CAAzB;AAAA,CAArB;;AAEA,IAAMK,2BAA2B,GAAjC;AACA,IAAMC,0BAA0B,EAAhC,C,CAAoC;;AAEpC,IAAMC,uBACH,gCAAU,EAACC,gBAAgB,KAAjB,EAAV,CADG,UAEH,8BAAQ,EAACC,UAAU,OAAO,EAAP,GAAY,EAAvB,EAAR,CAFG,UAOH,gCAAU,EAACD,gBAAgB,KAAjB,EAAV,CAPG,UAAe;AAGbf,OAHa;AAAA,wFAGPiB,MAHO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAIJX,aAAaM,wBAAb,EAAuC,gCAAeK,MAAf,CAAvC,CAJI;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAOiB;AAC9Bf,wBARa;AAAA;AAAA,UAQWgB,eARX,SAQWA,eARX;AAAA,UAQ4BC,cAR5B,SAQ4BA,cAR5B;AAAA,UAQ4CC,cAR5C,SAQ4CA,cAR5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBASJd,aAAaO,uBAAb,EAAsC,EAACK,gCAAD,EAAkBC,8BAAlB,EAAkCC,8BAAlC,EAAtC,CATI;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,CAAf,oQAAN;;AAaO,SAASpB,KAAT,CAAeiB,MAAf,EAAuB;AAC5B,SAAO;AACLI,WAAO,CAAC,IAAD,gCAAkB,IAAlB,CADF;AAELC,aACER,aACGd,KADH,CACSiB,MADT,EAEGM,IAFH,CAEQ;AAAA,aAAS,EAACC,aAAahB,IAAd,EAAT;AAAA,KAFR;AAHG,GAAP;AAOD;;AAEM,SAASP,YAAT,QAA4D;AAAA,MAArCwB,MAAqC,SAArCA,MAAqC;AAAA,MAA7BC,IAA6B,SAA7BA,IAA6B;AAAA,MAAvBC,MAAuB,SAAvBA,MAAuB;AAAA,MAAfC,YAAe,SAAfA,YAAe;;AACjE,SAAO,EAACC,0CAAD;AACLJ,kBADK,EACGC,UADH,EACSC,cADT,EACiBC,0BADjB,EAAP;AAED;;AAEM,SAAS1B,sBAAT,CAAgCe,MAAhC,EAAwC;AAC7C,SAAO;AACLI,WAAO,CAAC,IAAD,oDAAsC,IAAtC,CADF;AAELC,aAASR,aAAaZ,sBAAb,CAAoCe,MAApC;AAFJ,GAAP;AAID;;AAEM,SAASd,0BAAT,CAAoC2B,eAApC,EAAqD;AAC1D,SAAO;AACLD,gEADK;AAELC;AAFK,GAAP;AAID;;AAEM,SAAS1B,sBAAT,CAAgC2B,gBAAhC,EAAkD;AACvD,SAAO;AACLF,0DADK;AAELE;AAFK,GAAP;AAID;;AAEM,SAAS1B,UAAT,CAAoB2B,gBAApB,EAAsC;AAC3C,SAAO;AACLH,4CADK;AAELG;AAFK,GAAP;AAID","file":"MapActions.js","sourcesContent":["import {memoize, serialize} from 'async-decorators';\n\nimport {\n    CHANGE_BOUNDS_MAP,\n    MARKER_HOVER_INDEX_CHANGE_MAP,\n    QUERY_MAP,\n    SHOW_BALLON_MAP,\n    TABLE_HOVERED_ROWS_INDEX_CHANGE_MAP,\n    TABLE_VISIBLE_ROWS_CHANGE_MAP\n} from '../constants/map_actions_types.js';\n\nimport genMarkersData from '../hoverMap/components/examples/data/gen_markers_data.js';\n\n// to emulate server async call\nconst getDataAsync = (ms = 0, data = null) => new Promise(r => setTimeout(() => r(data), ms));\n\nconst K_EMUL_ROUNDTRIP_TIME_MS = 130;\nconst K_ROW_DEBOUNCE_INTERVAL = 16; // increase if you wanna show really big amount of markers\n\nconst asyncActions = {\n  @serialize({raiseSkipError: false}) // possible memory leak, check\n  @memoize({expireMs: 1000 * 60 * 15})\n  async query(params) {\n    return await getDataAsync(K_EMUL_ROUNDTRIP_TIME_MS, genMarkersData(params));\n  },\n\n  @serialize({raiseSkipError: false}) // skips all but first and last\n  async tableVisibleRowsChange({visibleRowFirst, visibleRowLast, maxVisibleRows}) {\n    return await getDataAsync(K_ROW_DEBOUNCE_INTERVAL, {visibleRowFirst, visibleRowLast, maxVisibleRows});\n  }\n};\n\nexport function query(params) {\n  return {\n    types: [null, QUERY_MAP, null],\n    promise:\n      asyncActions\n        .query(params)\n        .then(data => ({markersData: data}))\n  };\n}\n\nexport function changeBounds({center, zoom, bounds, marginBounds}) {\n  return {type: CHANGE_BOUNDS_MAP,\n    center, zoom, bounds, marginBounds};\n}\n\nexport function tableVisibleRowsChange(params) {\n  return {\n    types: [null, TABLE_VISIBLE_ROWS_CHANGE_MAP, null],\n    promise: asyncActions.tableVisibleRowsChange(params)\n  };\n}\n\nexport function tableHoveredRowIndexChange(hoveredRowIndex) {\n  return {\n    type: TABLE_HOVERED_ROWS_INDEX_CHANGE_MAP,\n    hoveredRowIndex\n  };\n}\n\nexport function markerHoverIndexChange(hoverMarkerIndex) {\n  return {\n    type: MARKER_HOVER_INDEX_CHANGE_MAP,\n    hoverMarkerIndex\n  };\n}\n\nexport function showBallon(openBalloonIndex) {\n  return {\n    type: SHOW_BALLON_MAP,\n    openBalloonIndex\n  };\n}\n"]}